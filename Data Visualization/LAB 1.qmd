---
title: "Quarto Presentation -- Starter Example"
subtitle: "Titanic Dataset"
author: "Gabriela Chajon"
format:
  revealjs:
    css: custom-style.css
editor: source
---


## INTRODUCTION
-   This is an introduction to creating presentation output using Quarto \
-   Notice how headers are used to create pages of content \
-   This is just a simple example - we will improve on the design and flow throughout the semester \
-   Use the CRISP-DM Model to create a relevant story line \



## Data Understanding
-   We will use the Titanic dataset for our analysis \
-   The dataset has information on all 1309 passengers aboard the Titanic when it sank in April 1912 \
-   The dataset has the following variables \
```{r}
library(titanic) 
library(dplyr)
titanic <- bind_rows(titanic_train, titanic_test)
str(titanic)     # look at the first rows of the dataset -- default is 6 rows
```


## Passenger Statistics by Gender
-   The Titanic had more men than women -- almost two-thirds were men.\
```{r}
table  <- table(titanic$Sex)
table
```

-   Percent distribution by gender 
```{r}
round(prop.table(table) *100, digits = 1)
```


## Passenger Statistics by Survival
-   These data show that fewer passengers survive than did not survive.\
-   However, there are quite a few passengers for whom no survival information is available.\
```{r}
titanic$Survived.f <- as.factor(ifelse(is.na(titanic$Survived), "Unsure",
                                       ifelse(titanic$Survived == 0, "Did Not Survive", "Survived")))
table  <- table(titanic$Survived.f)
table
```
    
-   Percent distribution by survival 
```{r}
round(prop.table(table) *100, digits = 1)
```


## Passenger Statistics by Gender and Survival
-   About half of the women are known to have survived \
-   While over half of the men are known to have perished \
```{r}
library(summarytools)
ctable(titanic$Sex,titanic$Survived.f, prop="r")
```

## Passenger Statistics by Gender and Survival
-   Most of the non-survivors were men while most of the survivors were women.\
```{r}
library(summarytools)
ctable(titanic$Sex,titanic$Survived.f, prop="c")
```

## Average Age by Gender
```{r}
xage <- round(mean(titanic$Age, na.rm = TRUE), digits = 0)

pip <- titanic %>% 
	group_by(Sex) %>% 
	summarize(Average_Age=mean(Age, na.rm = TRUE)) %>% 
	mutate(Average_Age = round(Average_Age, 0))

female_xage <- pip[pip$Sex=="female",]
male_xage   <- pip[pip$Sex=="male",]

xage
female_xage
male_xage
```
-   The average age of passengers on board the Titanic is 30 years old.\
-   The average age of female passengers is 29 years old.\
-   The average age of male passengers is 31 years old.\

  
## Average Age by Survival
Survivors tended to be younger than those who did not survive.\
```{r}
pip <- titanic %>% 
	group_by(Survived.f) %>% 
	summarize(Average_Age = mean(Age, na.rm = TRUE)) %>% 
	mutate(Average_Age = round(Average_Age, 0))
knitr::kable(pip, col.names = c("Survived", "Average Age"))

```


## Average Age by Gender and Survival
Non-surviving females are younger than surviving females. The opposite is true among males.\
The youngest group are female non-survivors.\
```{r}
pip <- titanic %>% 
	group_by(Sex, Survived.f) %>% 
	summarize(Average_Age = mean(Age, na.rm = TRUE)) %>% 
	mutate(Average_Age = round(Average_Age, 0))
knitr::kable(pip, col.names = c("Gender", "Survived", "Average Age"))
```


## Average Age by Fare Class and Survival
-   Passengers booked fares in First, Second, or Third class \
-   First class passengers tended to be older, regardless of survival status \
```{r}
pip <- titanic %>% 
	group_by(Survived.f, Pclass) %>% 
	summarize(Average_Age = mean(Age, na.rm = TRUE), .groups = 'drop') %>% 
	mutate(Average_Age = round(Average_Age, 0))
knitr::kable(pip, col.names = c("Survived", "Fare Class", "Average Age"))
```

## Average Age by Fare Class, Gender, and Survival
Among males, those who did not survive tended to be older than survivors, regardless of fare class.\
Among females, first class passengers who did not survive were *younger* than survivors. \
```{r}
pip <- titanic %>%
  group_by(Sex, Survived.f, Pclass) %>%
  summarize(Average_Age = mean(Age, na.rm = TRUE), .groups = 'drop') %>% 
	mutate(Average_Age = round(Average_Age, 0))

library(ggplot2)
ggplot(pip, aes(x = Pclass, y = Average_Age, fill = Survived.f)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  facet_wrap(~Sex, scales = "free_y") + # Creates separate plots for each gender, with free y scales
  labs(x = "Ticket Class", y = "Average Age", fill = "Survival Status") +
  theme_minimal() +
  ggtitle("Average Age of Titanic Passengers by Gender, Survival, and Ticket Class")
```


## Start your analysis using the Embark variable here
Note that passengers embarked at one of three locations.\
S: Southampton, England \
C: Cherbourg, France \
Q: Queenstown, Ireland \

```{r}
# fix missing labels and convert to a factor
titanic$Embarked <- ifelse(titanic$Embarked=="","Unknown",titanic$Embarked)
titanic$Embarked.f <- as.factor(titanic$Embarked)

fare_embark_table <- table(titanic$Pclass, titanic$Embarked.f)

print(fare_embark_table)
```

## Chart1
```{r}
# Fix missing labels and convert to a factor
titanic$Embarked <- ifelse(titanic$Embarked == "", "Unknown", titanic$Embarked)
titanic$Embarked.f <- as.factor(titanic$Embarked)

# Load ggplot2 package
library(ggplot2)

# Create a horizontal bar chart
ggplot(titanic, aes(x = factor(Pclass), fill = Embarked.f)) +
  geom_bar(position = "dodge", color = "black", stat = "count") +
  labs(title = "Distribution of Passengers by Embark Location and Fare Class",
       x = "Number of Passengers", y = "Fare Class",
       fill = "Embark Location") +
  scale_fill_manual(values = c("S" = "turquoise", "C" = "pink", "Q" = "darkorchid", "Unknown" = "burlywood")) +
  theme_minimal() +
  coord_flip()
```
## Chart1
```{r}
# Fix missing labels and convert to a factor
titanic$Embarked <- ifelse(titanic$Embarked == "", "Unknown", titanic$Embarked)
titanic$Embarked.f <- as.factor(titanic$Embarked)

# Load ggplot2 package
library(ggplot2)

# Create a stacked bar chart
ggplot(titanic, aes(x = Embarked.f, fill = factor(Pclass))) +
  geom_bar() +
  labs(title = "Distribution of Passengers by Fare Class and Embark Location",
       x = "Embark Location", y = "Number of Passengers",
       fill = "Fare Class") +
  scale_fill_manual(values = c("1" = "burlywood", "2" = "darkorchid", "3" = "turquoise")) +
  theme_minimal()+
  coord_flip()
```


## Analysis
The bar charts represents the distribution of passengers on the Titanic based on their fare class and embarkation location. It suggests that Southampton and Queenstown had a relatively larger number of 3rd class passengers than other classes while Cherbourg has a higher number of 1st class passenger. This observation suggests that Cherbourg appears to be a more common port used where wealthier passengers arrived while the other 2 ports showed the passengers from lower classes which make sense related to the amount of people which was less.

## Thank you 

##End
