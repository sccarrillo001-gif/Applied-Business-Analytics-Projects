---
title: "LAB 5"
author: "Gabriela Chajon"
format:
  html: 
    code-fold: false
    code-overflow: wrap
execute:
  warning: false
  messages: false
  echo: true
  include: true
toc: false
toc-location: left
number-sections: false
editor: source
---

```{r}
options(scipen=999) 
library(tidyverse)
library(socviz)
library(ggplot2)
head(gss_sm)
```
## Part 1

### Summarizing data 
```{r}
library(socviz)
pip1 <- gss_sm %>%         
  group_by(degree, polviews) %>%
  summarize(N = n()) %>% 
  mutate(freq = N/sum(N),
         pct = round((freq*100),0))
pip1
```

### Interpretation
The table shows the count of observations for each combination of degree and political views. Just by seeing the rows the data shows that the biggest amount is 607 observations for people that have a high school degree and presents moderate political views. It does make sense because it is  common for the majority of the population to identify with such views. 

## Part 2

### Stacked bar chart
```{r}
p <- ggplot(data = subset(pip1, !is.na(degree) & !is.na(polviews)), 
						aes(x=degree, y=pct, fill = polviews))

p + geom_col(position = "stack") +
    labs(x="Degree", y="Percent", fill = "Political views",
         title = "Degree and Political views" , 
         subtitle = "As a stacked bar chart") +
    geom_text(aes(label=pct), position = position_stack(vjust=.5))
```

### Dodged Bar chart
```{r}
p + geom_col(position = "dodge2") +
    labs(x="Degree", y="Percent", fill = "Political views",
         title = "Degree and political views", 
         subtitle = "As a dodged bar chart") + 
    geom_text(aes(label = pct), position = position_dodge(width = .9))
```
### Faceted horizontal bar chart
```{r}
p + geom_col(position = "dodge2") +
    labs(x=NULL, y="Percent", fill = "Religion",
         title = "Relationship of degree and political view", 
         subtitle = "As a faceted horizontal bar chart") +
         guides(fill = "none") +
         coord_flip() +
         facet_grid(~ polviews) +
    geom_text(aes(label = pct), position = position_dodge2(width = 1))
```
### Interpretation
The charts show that people with moderate political views are significantly more than others while extremely liberal and conservative views have the less percentage. It is not very significant but the percentage of people who identify as extremely liberal or liberal increases with higher levels of education. 

## Part 3

### Summarizing data (Add mean for 2 continuous variables)
```{r}
pip2 <- gss_sm %>%         
  group_by(polviews) %>%
  summarize(N = n(),
            age_mean = mean(age, na.rm = TRUE),
            sibs_mean = mean(sibs, na.rm = TRUE)) %>%
  mutate(freq = N/sum(N),
         pct = round((freq*100), 0))

pip2
```

## Part 4

### Scatterplot with 2 continuous and 1 categorical 

This code does not remove NA -- make sure you deal with that.\
```{r}
pip2 <- na.omit(pip2)
p <- ggplot(pip2, aes(x=sibs_mean, y=age_mean, color=polviews))
p + geom_point(size=5) +
    annotate(geom = "text", x = 3.55, y=49, 
    				 label = "More liberal responses show lower # of siblings", hjust=0.5) +
    labs(y="Average Age", x="Average Number of siblings.", 
         title="Age and Number of siblings by political views", 
         subtitle = "Average liberal political views decrease with less # of children",
         caption <- "gss_sm dataset{socviz}")
```
### Interpretation
More liberal responses show lower number of children. However it is harder to know if the relationship is significant because the average numbers are very close and the range is short.

## Part 5

### Modifications in the legend
```{r}
p <- ggplot(pip2, aes(x = sibs_mean, y = age_mean, color = polviews, fill = polviews)) +
  geom_point(size = 5) +
  annotate(geom = "text", x = 3.7, y = 53, 
           label = "Average conservative responses are the highest in age", hjust = 0.6) +
  labs(y = "Average Age", x = "Average Number of siblings",
       title = "Relationship between Average Age and Number of Siblings by Political Views",
       color = "Political Views", fill = "Political Views") +
  theme(legend.title = element_text(color = "darkmagenta", size = 14, face = "bold"),
        legend.position = "right",  # Adjust legend position
        axis.text = element_text(size = 15),  # Adjust axis text size
        axis.title = element_text(size = 15),  # Adjust axis title size
        plot.title = element_text(size = 13, face = "bold")) +  # Adjust plot title size
  scale_color_brewer(palette = "Set3") +
  scale_fill_brewer(palette = "Set3")

p
```
## Part 6
### Replace labels
```{r}
p <- ggplot(pip2, aes(x=sibs_mean, y=age_mean, color=polviews))
p + geom_point(size=2) +
    geom_text(mapping = aes(label=polviews), hjust=1, size=3) +
      annotate(geom = "text", x = 4, y=53, 
    				 label = "Conservative and moderate responses show bigger # of siblings", hjust=0.5) +
    annotate(geom = "text", x = 3.5, y=49, 
    				 label = "Average liberal responses are from younger people", hjust=0.5) +
    labs(y="Average Age", x="Average Number of Siblings", 
         title="Relationship between Average Age and Number of Siblings by Political View", 
         color = "Political Views") +
    theme(legend.position = "none") +
      scale_x_continuous(limits = c(3, 5))
```
## PART 7

### The chart shows that conservative political views are somewhat positively correlated to age of the respondents. The results make sense as older generations have usually more conservative beliefs and perspectives as they tend to become more resistant to change. Furthermore , people with a higher average number of conservative and moderate responses tend to fall into the higher average of siblings, but this is harder to determine because of the small range. The slight relationship between those two can be contributed to higher levels of peer influence or maybe socioeconomic status.



