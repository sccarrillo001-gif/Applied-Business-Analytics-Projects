---
title: "LAB 8"
author: "Gabriela CHajon"
format:
  html: 
    code-fold: false
    code-overflow: wrap
execute: 
  warning: false
  messages: false
  echo: true
toc: false
toc-location: left  
---

```{r}
options(scipen=999)
library(socviz) # use for the round_df() function
```

## First Chart

### Old chart




```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)  # Load ggplot2 package

```


```{r}
library(gapminder)
ggplot(gapminder, aes(x=year, y=gdpPercap)) +
   geom_line(aes(group = country)) + 
	 facet_wrap(country ~ continent)
library(socviz)
p <- ggplot(gss_sm, aes(x=bigregion)) 
p + geom_bar() + 
	  labs(title = "Figure 4.6: A bar chart.") 
```



### New chart


```{r}
library(socviz)
library(ggplot2)

# Define warm colors
warm_colors <- c("#FFA07A", "#FF7F50", "#FF6347", "#FF4500", "#FF8C00", "#FFA500")

# Create the plot
p <- ggplot(gss_sm, aes(y = bigregion, fill = bigregion)) +  # Switch x and y aesthetics for horizontal bars
  geom_bar(stat = "count") +  # Use stat = "count" instead of geom_bar()
  coord_flip() +  # Flip the coordinates to make the bars horizontal
  scale_fill_manual(values = warm_colors) +  # Set warm colors for the bars
  labs(title = "Figure 4.6: A bar chart.", fill = NULL) +  # Remove fill legend and add pink title
  theme(
    plot.title = element_text(color = "#FF69B4", size = 14, face = "bold")  # Set pink color for title
  )

# Print the plot
print(p)
```
```{r}
library(socviz)
library(ggplot2)

# Define warm colors
warm_colors <- c("#FFA07A", "#FF7F50", "#FF6347", "#FF4500", "#FF8C00", "#FFA500")

# Create the plot
p <- ggplot(gss_sm, aes(y = bigregion, fill = bigregion)) +  
  geom_bar(stat = "count", width = 0.7, color = "black") +  # Adjust bar width and add black outline
  scale_fill_manual(values = warm_colors) +  
  labs(title = "Distribution of Big Regions", 
       x = "Count",  # Change x-axis label to "Count"
       y = "Big Region") +  
  theme_minimal() +  
  theme(
    plot.title = element_text(color = "#FF69B4", size = 16, face = "bold"),  # Increase title size
    axis.title = element_text(size = 14),  # Adjust axis title size
    axis.text = element_text(size = 12),  # Adjust axis text size
    legend.position = "none",  # Remove legend
    panel.grid.major.y = element_blank(),  # Remove horizontal gridlines
    panel.grid.minor.y = element_blank()   # Remove minor gridlines
  )

print(p)

```

### OBSERVATIONS 
The two refinements applied to the bar chart enhance its visual clarity and interpretability. By making the bars slightly wider and adding the outline, it becomes easier for viewers to discern individual bars within the plot, especially when multiple bars are closely clustered together. This refinement ensures that the audience can accurately perceive and compare the distribution of big regions across the dataset.

In the bar chart showing the distribution of big regions, assigning different warm colors to each region (e.g., Northeast, Midwest, South, West) allows viewers to quickly identify and differentiate between the regions. Switching from a horizontal to a vertical bar chart alters the visual presentation, enhancing readability and comparison. The vertical orientation aligns with the typical left-to-right reading pattern, facilitating a more natural progression in data interpretation. It also provides ample space for longer category labels and allows for easier comparison between categories, contributing to a clearer understanding of the data relationships. 

## SECOND CHART

### OLD CHART

```{r}
library(socviz)
p <- ggplot(gss_sm, aes(x=age, y=childs))+
	   geom_point(alpha = 0.2) + 
     geom_smooth()  
p
```

### NEW CHART 
```{r}
library(socviz)
library(ggplot2)

# Load the gss_sm dataset if it's not already loaded
data(gss_sm)

# Refine the plot
p <- ggplot(gss_sm, aes(x = age, y = childs)) +
  geom_point(alpha = 0.2, color = "darkblue", size = 2) +  # Refinement 1: Adjust alpha, color, and size of points
  geom_smooth(method = "loess", color = "darkred", se = FALSE) +  # Refinement 2: Change smoothing method to loess, adjust color, and remove standard error ribbon
  labs(title = "Scatterplot of Age and Number of Children",
       x = "Age",
       y = "Number of Children") +
  theme_minimal() +  # Refinement 3: Change theme to minimal
  theme(plot.title = element_text(size = 14, face = "bold"),  # Refinement 4: Increase title size and make it bold
        axis.title = element_text(size = 12),  # Refinement 5: Adjust axis title size
        axis.text = element_text(size = 10))  # Refinement 6: Adjust axis text size

print(p)

```


```{r}
library(socviz)
p <- ggplot(gss_sm, aes(x = age, y = childs)) +
  geom_point(alpha = 0.6, color = "darkblue", size = 2) +
  geom_smooth(method = "loess", se = FALSE, color = "darkred", linetype = "solid", size = 3) +  # Increased line thickness to 1.5
  labs(title = "Relationship between Age and Number of Children",  # Added a descriptive title
       x = "Age (years)",  # Improved clarity of x-axis label
       y = "Number of Children") +
  theme_bw() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),  # Increased title font size and made it bold
    axis.title.x = element_text(size = 12),  # Increased x-axis label font size
    axis.title.y = element_text(size = 12)  # Increased y-axis label font size
  )
p

```
### Observations 
The first plot is an improvement over the second one for several reasons. Firstly, the use of different colors for the point and line elements enhances visual contrast, making it easier to differentiate between the data points and the smoothing line. Additionally, increasing the thickness of the smoothing line in the first plot further emphasizes its trend, making it more noticeable compared to the thinner line in the second plot. Furthermore, the inclusion of a descriptive title ("Relationship between Age and Number of Children") in the first plot provides clear context to the visualization, helping viewers understand the purpose of the plot at a glance. Moreover, specifying units in the x-axis label ("Age (years)") in the first plot improves the clarity of the axis, ensuring viewers interpret the data accurately.


The general relationship depicted in the plot indicates how the number of children tends to change as individuals age.Since the line slopes upward, it suggests that, on average, individuals tend to have more children as they get older, indicating a positive correlation between age and the number of children.


